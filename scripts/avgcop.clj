(require '[lgo.analysis.katago :refer [katago-output]])
(require '[lgo.analysis.processing :refer [cost-of-passing-data]])
(require '[lgo.util :refer [filename-without-extension]])
(require '[clojure.java.io])

(def fs ["1942-10-29a.out"
        ;;  "1962-07-13b.out"
        ;;  "1964-07-05a.out"
        ;;  "1986-05-13b.out"
        ;;  "1995-04-07a.out"
        ;;  "1995-04-20e.out"
        ;;  "1995-06-15b.out"
        ;;  "1999-03-08a.out"
        ;;  "2005-04-11h.out"
        ;;  "2005-11-28c.out"
        ;;  "2005-11-28d.out"
        ;;  "2011-11-00a.out"
        ;;  "2011-11-00b.out"
        ;;  "2015-07-29ad.out"
        ;;  "2016-11-25b.out"
        ;;  "2017-03-18m.out"
        ;;  "2019-01-07q.out"
        ;;  "2019-01-10i.out"
        ;;  "2019-01-10u.out"
        ;;  "2019-01-17c.out"
        ;;  "2019-01-17i.out"
        ;;  "2019-01-31d.out"
        ;;  "2019-02-07a.out" 
        ;;  "2019-02-14e.out"
        ;;  "2019-02-21d.out"
        ;;  "2019-02-21e.out"
        ;;  "2019-03-07r.out"
        ;;  "2019-03-07s.out"
        ;;  "2019-03-14f.out"
        ;;  "2019-03-14g.out"
        ;;  "2019-03-14h.out"
        ;;  "2019-03-14j.out"
        ;;  "2019-03-14k.out"
        ;;  "2019-03-14t.out"
        ;;  "2019-03-16c.out"
        ;;  "2019-03-21a.out"
        ;;  "2019-03-21o.out"
        ;;  "2019-03-28a.out"
        ;;  "2019-03-28b.out"
        ;;  "2019-04-01a.out"
        ;;  "2019-04-04f.out"
        ;;  "2019-04-05b.out"
        ;;  "2019-04-05c.out"
        ;;  "2019-04-05d.out"
        ;;  "2019-04-05e.out"
        ;;  "2019-04-08b.out"
        ;;  "2019-04-10a.out"
        ;;  "2020-01-09d.out"
        ;;  "2020-01-16b.out"
        ;;  "2020-01-16c.out"
        ;;  "2020-01-18d.out"
        ;;  "2020-01-23e.out"
        ;;  "2020-01-23k.out"
        ;;  "2020-01-23l.out"
        ;;  "2020-01-23m.out"
        ;;  "2020-01-23n.out"
        ;;  "2020-01-30u.out"
        ;;  "2020-01-30v.out"
        ;;  "2020-01-30w.out"
        ;;  "2020-01-30x.out"
        ;;  "2020-01-30y.out"
        ;;  "2020-01-30z.out"
        ;;  "2020-02-06g.out"
        ;;  "2020-02-06o.out"
        ;;  "2020-02-06p.out"
        ;;  "2020-02-06q.out"
        ;;  "2020-02-06r.out" 
        ;;  "2020-02-13r.out"
        ;;  "2020-02-13v.out"
        ;;  "2020-02-13w.out"
        ;;  "2020-02-19m.out"
        ;;  "2020-02-20p.out"
        ;;  "2020-02-20q.out"
        ;;  "2020-02-20r.out"
        ;;  "2020-02-20s.out"
        ;;  "2020-02-20x.out"
        ;;  "2020-02-20y.out"
        ;;  "2021-01-06b.out"
        ;;  "2021-01-07e.out"
        ;;  "2021-01-14a.out"
        ;;  "2021-01-20a.out"
        ;;  "2021-01-20b.out"
        ;;  "2021-01-21e.out"
        ;;  "2021-01-21h.out"
        ;;  "2021-01-25m.out"
        ;;  "2021-01-27b.out"
        ;;  "2021-02-03c.out"
        ;;  "2021-02-04c.out"
        ;;  "2021-02-04d.out"
        ;;  "2021-02-10a.out"
        ;;  "2021-02-11b.out"
        ;;  "2021-02-17a.out"
        ;;  "2021-02-17b.out"
        ;;  "2021-02-18d.out"
        ;;  "2021-02-18l.out"
        ;;  "2021-02-24d.out"
        ;;  "2021-03-03b.out"
        ;;  "2021-03-04d.out"
        ;;  "2021-03-04f.out"
        ;;  "2021-03-04g.out"
        ;;  "2021-03-11b.out"
        ;;  "2021-03-11c.out"
        ;;  "2021-03-11i.out"
        ;;  "2021-03-15e.out"
        ;;  "2021-03-15f.out"
        ;;  "2021-03-18a.out"
        ;;  "2021-03-18j.out"
        ;;  "2021-03-22i.out"
        ;;  "2021-03-24i.out"
        ;;  "2021-03-25d.out"
        ;;  "2022-01-06b.out"
        ;;  "2022-01-10a.out"
        ;;  "2022-01-17a.out"
        ;;  "2022-01-19d.out"
        ;;  "2022-01-26a.out"
        ;;  "2022-01-27f.out"
        ;;  "2022-02-03c.out"
        ;;  "2022-02-10e.out"
        ;;  "2022-02-10f.out"
        ;;  "2022-02-16a.out"
        ;;  "2022-02-18b.out"
        ;;  "2022-02-24e.out"
        ;;  "2022-02-24f.out"
        ;;  "2022-02-28j.out"
        ;;  "2022-03-02b.out"
        ;;  "2022-03-10c.out"
        ;;  "2022-03-14a.out"
        ;;  "2022-03-14b.out"
        ;;  "2022-03-23b.out"
        ;;  "2022-03-23c.out"
        ;;  "2022-03-26b.out"
        ;;  "2022-03-29d.out"
        ;;  "2022-03-31a.out"
        ;;  "2022-03-31c.out"
        ;;  "2022-03-31d.out"
        ;;  "2022-03-31e.out"
        ;;  "2022-03-31f.out"
        ;;  "2022-04-04a.out"
        ;;  "2022-04-07d.out"
        ;;  "2022-04-14f.out"
        ;;  "2022-04-21a.out"
        ;;  "2022-04-25h.out"
        ;;  "2022-04-27b.out"
        ;;  "2022-04-28e.out"
        ;;  "2022-05-02a.out"
        ;;  "2022-05-02c.out"
        ;;  "2022-05-05a.out"
        ;;  "2022-05-10a.out"
        ;;  "2022-05-11d.out"
        ;;  "2022-05-12b.out"
        ;;  "2022-05-16b.out"
        ;;  "2022-05-16c.out"
        ;;  "2022-05-19b.out"
         "2022-05-24a.out"])

(defn printer
  [files]
  (let [raws (into {} (map
                       (fn [filename]
                         (println "processing" filename) 
                         (katago-output filename))
                       files))]
    (doseq [raw raws]
      (let [copd (cost-of-passing-data raw)
            s (apply + (map :cop copd))
            m (count copd)]
        (println raw s m)
        ;; (println (str
        ;;           (format  "Total cop: %.2f" (double s)) " for " m " moves. "
        ;;           (format "Average: %.2f"  (double (/ s m)))))
        ))))

(printer fs)